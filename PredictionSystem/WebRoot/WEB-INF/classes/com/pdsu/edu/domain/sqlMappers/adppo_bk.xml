<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pdsu.edu.domain.Adppo">
	<resultMap type="com.pdsu.edu.domain.Adppo" id="adppoResult">
    <id column="ppono" property="ppono" jdbcType="DECIMAL" />
    <id column="provtype" property="provtype" jdbcType="VARCHAR" />
    <id column="taxid" property="taxid" jdbcType="VARCHAR" />
    <id column="spec" property="spec" jdbcType="VARCHAR" />
    <id column="ox1" property="ox1" jdbcType="VARCHAR" />
    <id column="oy1" property="oy1" jdbcType="VARCHAR" />
    <id column="ox2" property="ox2" jdbcType="VARCHAR" />
    <id column="oy2" property="oy2" jdbcType="VARCHAR" />
    <id column="ix1" property="ix1" jdbcType="VARCHAR" />
    <id column="iy1" property="iy1" jdbcType="VARCHAR" />
    <id column="ix2" property="ix2" jdbcType="VARCHAR" />
    <id column="iy2" property="iy2" jdbcType="VARCHAR" />
    <id column="provname" property="provname" jdbcType="VARCHAR" />
    <id column="provst" property="provst" jdbcType="VARCHAR" />
    <id column="mastgroup" property="mastgroup" jdbcType="DECIMAL" />
    <id column="ssn" property="ssn" jdbcType="DECIMAL" />
    <id column="corporationid" property="corporationid" jdbcType="VARCHAR" />
    <id column="newfeaturesind" property="newfeaturesind" jdbcType="DECIMAL" />
    <id column="grnumber" property="grnumber" jdbcType="DECIMAL" />
     
		<result column="ppo" property="ppo" jdbcType="DECIMAL" />
		<result column="ppo_name" property="ppo_name" jdbcType="VARCHAR" /> 
		<result column="specialty_id" property="specialty_id" jdbcType="DECIMAL" />
		<result column="specialty" property="specialty" jdbcType="VARCHAR" /> 
		<result column="lat" property="lat" jdbcType="DECIMAL" />
		<result column="lon" property="lon" jdbcType="DECIMAL" />
		<result column="latlon" property="latlon" jdbcType="DECIMAL" />

		<result column="name" property="name" jdbcType="VARCHAR" /> 
		<result column="address1" property="address1" jdbcType="VARCHAR" /> 
		<result column="address2" property="address2" jdbcType="VARCHAR" /> 
		<result column="city" property="city" jdbcType="VARCHAR" /> 
		<result column="st" property="st" jdbcType="VARCHAR" /> 
		<result column="phone" property="phone" jdbcType="VARCHAR" /> 
		<result column="lname" property="lname" jdbcType="VARCHAR" /> 
		<result column="fname" property="fname" jdbcType="VARCHAR" /> 
		<result column="effdate" property="effdate" jdbcType="VARCHAR" /> 
		<result column="termdate" property="termdate" jdbcType="VARCHAR" />  
		<result column="zip" property="zip" jdbcType="DECIMAL" /> 
		<result column="cartid" property="cartid" jdbcType="DECIMAL" /> 
		<result column="carttId" property="carttId" jdbcType="DECIMAL" /> 
		
		
		<result column="specific_plan_type" property="specific_plan_type" jdbcType="VARCHAR" /> 
		<result column="CoverageTypeID" property="CoverageTypeID" jdbcType="VARCHAR" /> 
		<result column="nationalPPO" property="nationalPPO" jdbcType="VARCHAR" /> 
		<result column="PPO_WebUrl" property="PPO_WebUrl" jdbcType="VARCHAR" /> 
		<result column="seq" property="seq" jdbcType="VARCHAR" /> 
		
		<result column="memberlogin" property="memberlogin" jdbcType="VARCHAR" /> 
		<result column="Provcode" property="Provcode" jdbcType="VARCHAR" /> 
		
		
		<result column="poscode" property="poscode" jdbcType="VARCHAR" /> 
		<result column="serviceamt" property="serviceamt" jdbcType="VARCHAR" /> 
		<result column="sqlstr" property="sqlstr" jdbcType="VARCHAR" /> 
		<result column="proccd" property="proccd" jdbcType="VARCHAR" /> 
		<result column="descr" property="descr" jdbcType="VARCHAR" /> 
		
		<result column="pagelow" property="pagelow" jdbcType="VARCHAR" /> 
		<result column="pageup" property="pageup" jdbcType="VARCHAR" /> 
		<result column="total" property="total" jdbcType="DECIMAL" />
		
		 
	</resultMap>
	
	<select id="selmembercart"  parameterType="adppo" resultMap="adppoResult">
	select  cartid,providername as name,  address1,  address2,  city, St,  zip, 
     specialty,  phone,  lname,  fname, effdate, termdate,latlon,poscode,serviceamt
     from TBL_ADVANCEEOB_MEMBERCART   
		<where>
			<if test="memberlogin != null" >
				and memberlogin=#{memberlogin}
			</if>
			<if test="cartid != null" >
				and cartid=#{cartid}
			</if>
			<if test="ssn != null" >
				and ssn=#{ssn}
			</if>
		</where> 
		order by 
			<if test="seq == 'filDistance'" >
				 latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 serviceamt,
			 </if>
			 providername
	</select>
	
	
 	<insert id="insertmembercart" parameterType="Adppo">
 		<selectKey resultType="java.lang.Long" keyProperty="carttId" order="BEFORE" >
	      select MISP.SEQ_TBL_ADVANCEEOB_CART.nextval from dual
	     </selectKey> 
 	 insert into TBL_ADVANCEEOB_MEMBERCART(cartid,providername,address1,address2,city,st,zip,specialty,phone,lname,fname,effdate,termdate,latlon,memberlogin,poscode,serviceamt,ssn)
     values(#{carttId,jdbcType=DECIMAL}
     ,#{name,jdbcType=VARCHAR}
     ,#{address1,jdbcType=VARCHAR}
     ,#{address2,jdbcType=VARCHAR}
     ,#{city,jdbcType=VARCHAR}
     ,#{st,jdbcType=VARCHAR}
     ,#{zip,jdbcType=VARCHAR}
     ,#{specialty,jdbcType=VARCHAR}
     ,#{phone,jdbcType=VARCHAR}
     ,#{lname,jdbcType=VARCHAR}
     ,#{fname,jdbcType=VARCHAR}
     ,#{effdate,jdbcType=VARCHAR}
     ,#{termdate,jdbcType=VARCHAR}
     ,#{latlon,jdbcType=VARCHAR}
     ,#{memberlogin,jdbcType=VARCHAR}
     ,#{poscode,jdbcType=VARCHAR}
     ,#{serviceamt,jdbcType=VARCHAR}
     ,#{ssn,jdbcType=VARCHAR}
     )
 	</insert>
 	   
 	 
	<delete id="deltmembercart" parameterType="Adppo">
		delete from TBL_ADVANCEEOB_MEMBERCART 
		<where>
			<if test="cartid != null" >
		    	and cartid=#{cartid}
		    </if>   
		</where> 
	</delete>
 	 
	
	
	<select id="selppoAll"  parameterType="adppo" resultMap="adppoResult">
		select ppo, ppo_name   from tbl_PPO  where insql != 0 
		order by ppo_name
	</select>
	 
	<select id="selppoSpecialty"  parameterType="adppo" resultMap="adppoResult">
		select distinct specialty,specialty_id
		from Tbl_PPO_Specialty_Conversion a
		inner join Tbl_Specialty b on a.spec1=b.specialty_id 
		<where>
			<if test="ppono != null" >
				and a.ppo=#{ppono}
			</if>
		</where> 
		order by specialty
	</select>
	
	<select id="selLatlon"  parameterType="adppo" resultMap="adppoResult">
		<!-- select lat, lon from tbl_ZipFull  where zip = 96854; -->
		select latitude as lat,longitude as lon
		from  tbl_zipcodes
		<where>
			<if test="zip != null" >
				and zipcode=#{zip}
			</if>
		</where>  
	</select>
	
	<select id="selProccd"  parameterType="adppo" resultMap="adppoResult">
	select proccd,descr 
  	from PROCEDUR
  	<where>
  		(fromdt is null or fromdt&lt;=sysdate) and (thrudt is null or thrudt&gt;=sysdate)
  	<if test="sqlstr != null" >
  		and ${sqlstr}
  	</if> 
   	   and rownum&lt;30
   	</where>
	</select>
	
	
	<select id="selProbylocationtaxid"  parameterType="adppo" resultMap="adppoResult">
	with aa as(
	Select DISTINCT  a.name, a.address1, a.address2, a.city,a.St, a.zip, 
  	b.specialty, a.phone, a.lname, a.fname,a.effdate,a.termdate 
  	--,abs(c.latitude-${ix1}) AS latt,abs(c.longitude-${iy1}) AS longg
    --,abs(c.latitude-34.7333)*abs(c.latitude-34.7333)+abs(c.longitude-118.1492)*abs(c.longitude-118.1492) as latlon1
  	, power(abs(c.latitude-${ix1})*abs(c.latitude-${ix1})+abs(c.longitude-${iy1})*abs(c.longitude-${iy1}),0.5) as latlon
  	
  	<if test="ppono != null" >
    FROM PPO_${ppono} a
    </if>
    <if test="ppono == null" >
    FROM PPO_102 a 
    </if>
    LEFT JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
	INNER JOIN tbl_zipcodes c ON a.zip=c.zipcode 
	 
	<where>
		(a.termdate >= sysdate or a.termdate is null) 
			<if test="provtype != null" >
				and b.providertype=#{provtype}
			</if>
			<if test="provname != null" >
				and a.name like '%${provname}%'
			</if>
			<if test="spec != null" >
				and a.spec1 in (${spec})
			</if>
			 
		 
			<if test="ox1 != null" >
			   AND (c.latitude &gt;= ${ox1}) and (c.latitude &lt;= ${ox2})
			   AND (c.longitude &lt;= ${oy2}) and (c.longitude &gt;= ${oy1})
			</if> 
			
			<if test="taxid != null" >
				and a.NPI =#{taxid}
			</if>
			  
			<if test="provst != null" >
				and a.st =#{provst}
			 </if>
	</where>
	order by 
			<if test="seq == 'filDistance'" >
				 latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 
			 </if>
	a.name
	<!--
			
			<if test="seq == null" >
				 order by a.name
			 </if>
	order by a.name
	-->
	)
	select a.*,e.cartid
	from aa a
	left join TBL_ADVANCEEOB_MEMBERCART e on a.name=e.providername 
	and  a.address1=e.address1  
	and  a.city=e.city 
	and a.St=e.St 
	and  a.zip=e.zip 
	and a.specialty=e.specialty 
	</select>
	
	
	<select id="selProbylocationtaxidFHsize"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos as (
	     select name,address1,city,St, zip, phone, spec1,
	      
	     taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,
	      
	     taxid,npi,specialty
	     )
	     
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlrate
     ,substr(a.postalcode,1,5) as zipcode 
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='P' and a.prov_npi_1 is not null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
    
 	)
	,c as(
	 select c.cntlrate,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,''as comments ,c.codeversion
	 from TBL_FH_PRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	 where c.poscode!=99
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate, '' as termdate 
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a1 a
	   <if test="ppono != null" >
	   inner join ppos e on a.prov_npi_1=e.npi and a.provtaxid=e.taxid 
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlrate=c.cntlrate     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
	 )
		select count(1) as total
		 from f
	</select>
	
	
	
	
	<select id="selProbylocationtaxidFH"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			<if test="provst != null" >
		  		,'' AS latlon
		  	</if>
		  	<if test="provst == null" >
			, power(abs(latitude-(${ix1}))*abs(latitude-(${ix1}))+abs(longitude-(${iy1}))*abs(longitude-(${iy1})),0.5)*111 as latlon
			</if>
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos2 as (
	     select name,address1,city,St, zip, phone, spec1,
	      
	     taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,
	      
	     taxid,npi,specialty
	     )
	     ,ppos as (
	     select distinct a.*
	     from ppos0 a 
	     inner join ppos2 b on a.name=b.name
	                        and a.address1=b.address1
	                        and a.city=b.city
	                        and a.St=b.St
	                        and a.zip=b.zip
	                        and a.phone=b.phone
	                        and a.spec1=b.spec1
	                         
	                        and a.taxid=b.taxid
	                        and a.npi=b.npi
	                        and a.specialty=b.specialty
	                        and a.effdate=b.effdate
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlrate
     ,substr(a.postalcode,1,5) as zipcode 
     <if test="taxid == null" >
     ,d.latlon 
     </if>
     <if test="taxid != null" >
     ,'' as latlon
     </if>
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='P' and a.prov_npi_1 is not null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
     order by  
       <if test="taxid == null" >
     	<if test="seq == 'filDistance'" >
				 d.latlon,
		</if>
		</if>
		a.name
 	)
	,c as(
	 select c.cntlrate,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,''as comments ,c.codeversion
	 from TBL_FH_PRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	 where c.poscode!=99
	)
 	,a as(
	 select a1.*
	 from a1
	 
	 <if test="ppono == 38" >
	 --WHERE  rownum&lt;=100 --and exists(select 1 from c where a1.cntlrate=c.cntlrate )
	 </if>
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate, e.termdate 
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a
	   <if test="ppono != null" >
	   inner join ppos e on a.prov_npi_1=e.npi and a.provtaxid=e.taxid 
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlrate=c.cntlrate     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		 order by serviceamt
	 )
	 ,asa as (
		 select b.*
		 from f
		 inner join b on f.prov_npi_1=b.prov_npi_1
		 --and f.provtaxid=b.provtaxid
		 and f.internalprovnum =b.internalprovnum
		 and f.provtype =b.provtype
		 and f.name=b.name
		 and f.address1=b.address1
		 and f.city=b.city
		 and f.state=b.state
		 and f.postalcode=b.postalcode
		 --and f.cntlrate=b.cntlrate
		 and f.serviceamt=b.serviceamt
		 
			
		  order by
		    <if test="seq == 'filDistance'" >
				 b.latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 f.serviceamt,
			 </if>
			 <if test="seq == 'filSpec'" >
				 specialty,
			 </if>
		     b.name,b.prov_npi_1--,b.provtaxid
		     ,b.internalprovnum ,specialty,
		     b.provtype ,b.address1,b.city,b.state ,b.postalcode ,b.codetype,b.code,b.poscode,b.serviceamt 
		)
	 ,asa1 as (
	 select prov_npi_1--,provtaxid
	 ,internalprovnum ,provtype ,
	 name, 
	 address1, city, 
	 state, 
	 postalcode --,cntlrate 
	 ,zipcode ,latlon 
	  , phone, specialty ,effdate,termdate 
	 ,codetype,code,negratetype,serviceamt,poscode,comments ,codeversion ,rownum as rownumid
	 from asa
	 )
	 select *
	 from asa1
	 <where>
		 <if test="pagelow != null" >
	   			and ( rownumid &gt;=${pagelow} and rownumid &lt;=${pageup})
			</if>
		</where>
	</select>
	
	
	<select id="selProbylocationtaxidFHS"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			<if test="provst != null" >
		  		,'' AS latlon
		  	</if>
		  	<if test="provst == null" >
			, power(abs(latitude-(${ix1}))*abs(latitude-(${ix1}))+abs(longitude-(${iy1}))*abs(longitude-(${iy1})),0.5)*111 as latlon
			</if>
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		substr(a.keyid,1,instr(a.keyid,'_')-1) as keyid,a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos2 as (
	     select name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty
	     )
	     ,ppos as (
	     select distinct a.*
	     from ppos0 a 
	     inner join ppos2 b on a.name=b.name
	                        and a.address1=b.address1
	                        and a.city=b.city
	                        and a.St=b.St
	                        and a.zip=b.zip
	                        and a.phone=b.phone
	                        and a.spec1=b.spec1
	                        and a.keyid=b.keyid
	                        and a.taxid=b.taxid
	                        and a.npi=b.npi
	                        and a.specialty=b.specialty
	                        and a.effdate=b.effdate
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlrate
     ,substr(a.postalcode,1,5) as zipcode 
     <if test="taxid == null" >
     ,d.latlon 
     </if>
     <if test="taxid != null" >
     ,'' as latlon
     </if>
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='P' and a.prov_npi_1 is  null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
     order by  
       <if test="taxid == null" >
     	<if test="seq == 'filDistance'" >
				 d.latlon,
		</if>
		</if>
		a.name
 	)
	,c as(
	 select c.cntlrate,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,''as comments ,c.codeversion
	 from TBL_FH_PRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
 	,a as(
	 select a1.*
	 from a1
	 
	 <if test="ppono == 38" >
	 --WHERE  rownum&lt;=100 --and exists(select 1 from c where a1.cntlrate=c.cntlrate )
	 </if>
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate,e.termdate 
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a
	   <if test="ppono != null" >
	   inner join ppos e on a.provtaxid=e.taxid and a.internalprovnum = e.keyid
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlrate=c.cntlrate     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		 order by serviceamt
	 )
	,asa as (
		 select b.*
		 from f
		 inner join b on f.prov_npi_1=b.prov_npi_1
		 --and f.provtaxid=b.provtaxid
		 and f.internalprovnum =b.internalprovnum
		 and f.provtype =b.provtype
		 and f.name=b.name
		 and f.address1=b.address1
		 and f.city=b.city
		 and f.state=b.state
		 and f.postalcode=b.postalcode
		 --and f.cntlrate=b.cntlrate
		 and f.serviceamt=b.serviceamt
		 
			
		  order by
		    <if test="seq == 'filDistance'" >
				 b.latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 f.serviceamt,
			 </if>
			 <if test="seq == 'filSpec'" >
				 specialty,
			 </if>
		     b.name,b.prov_npi_1--,b.provtaxid
		     ,b.internalprovnum ,specialty,
		     b.provtype ,b.address1,b.city,b.state ,b.postalcode ,b.codetype,b.code,b.poscode,b.serviceamt 
		)
	 ,asa1 as (
	 select prov_npi_1--,provtaxid
	 ,internalprovnum ,provtype ,
	 name, 
	 address1, city, 
	 state, 
	 postalcode --,cntlrate 
	 ,zipcode ,latlon 
	  , phone, specialty ,effdate,termdate 
	 ,codetype,code,negratetype,serviceamt,poscode,comments ,codeversion ,rownum as rownumid
	 from asa
	 )
	 select *
	 from asa1
	 
	 <where>
		 <if test="pagelow != null" >
	   			and ( rownumid &gt;=${pagelow} and rownumid &lt;=${pageup})
			</if>
		</where>
	</select>
	<select id="selProbylocationtaxidFHSsize"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		substr(a.keyid,1,instr(a.keyid,'_')-1) as keyid,a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos as (
	     select name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty
	     )
	     
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlrate
     ,substr(a.postalcode,1,5) as zipcode 
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='P' and a.prov_npi_1 is  null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
 	)
	,c as(
	 select c.cntlrate,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,''as comments ,c.codeversion
	 from TBL_FH_PRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate, '' as termdate  
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a1 a
	   <if test="ppono != null" >
	   inner join ppos e on a.provtaxid=e.taxid and a.internalprovnum = e.keyid
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlrate=c.cntlrate     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlrate
	 )
	
		select count(1) as total
		 from f
	</select>
	
	
	<select id="selProbylocationtaxidFHF"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode}
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			<if test="provst != null" >
		  		,'' AS latlon
		  	</if>
		  	<if test="provst == null" >
			, power(abs(latitude-(${ix1}))*abs(latitude-(${ix1}))+abs(longitude-(${iy1}))*abs(longitude-(${iy1})),0.5)*111 as latlon
			</if>
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos2 as (
	     select name,address1,city,St, zip, phone, spec1, taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1, taxid,npi,specialty
	     )
	     ,ppos as (
	     select distinct a.*
	     from ppos0 a 
	     inner join ppos2 b on a.name=b.name
	                        and a.address1=b.address1
	                        and a.city=b.city
	                        and a.St=b.St
	                        and a.zip=b.zip
	                        and a.phone=b.phone
	                        and a.spec1=b.spec1
	                        
	                        and a.taxid=b.taxid
	                        and a.npi=b.npi
	                        and a.specialty=b.specialty
	                        and a.effdate=b.effdate
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlpkg
     ,substr(a.postalcode,1,5) as zipcode 
     <if test="taxid == null" >
     ,d.latlon 
     </if>
     <if test="taxid != null" >
     ,'' as latlon
     </if>
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='F' and a.prov_npi_1 is not null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
     order by  
       <if test="taxid == null" >
     	<if test="seq == 'filDistance'" >
				 d.latlon,
		</if>
		</if>
		a.name
 	)
	,c as(
	 select c.cntlpkg,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
	 from TBL_FH_FRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
 	,a as(
	 select a1.*
	 from a1
	 
	 <if test="ppono == 38" >
	 --WHERE  rownum&lt;=100 --and exists(select 1 from c where a1.cntlpkg=c.cntlpkg )
	 </if>
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate,e.termdate 
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a
	   <if test="ppono != null" >
	   inner join ppos e on a.prov_npi_1=e.npi and a.provtaxid=e.taxid 
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlpkg=c.cntlpkg  
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		 order by serviceamt
	 )
	 ,asa as (
		 select b.*
		 from f
		 inner join b on f.prov_npi_1=b.prov_npi_1
		 --and f.provtaxid=b.provtaxid
		 and f.internalprovnum =b.internalprovnum
		 and f.provtype =b.provtype
		 and f.name=b.name
		 and f.address1=b.address1
		 and f.city=b.city
		 and f.state=b.state
		 and f.postalcode=b.postalcode
		 --and f.cntlpkg=b.cntlpkg
		 and f.serviceamt=b.serviceamt
		  
			
		  order by
		    <if test="seq == 'filDistance'" >
				 b.latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 f.serviceamt,
			 </if>
			 <if test="seq == 'filSpec'" >
				 specialty,
			 </if>
		     b.name,b.prov_npi_1--,b.provtaxid
		     ,b.internalprovnum ,specialty,
		     b.provtype ,b.address1,b.city,b.state ,b.postalcode ,b.codetype,b.code,b.poscode,b.serviceamt 
	)
	,asa1 as (
	 select prov_npi_1--,provtaxid
	 ,internalprovnum ,provtype ,
	 name, 
	 address1, city, 
	 state, 
	 postalcode --,cntlpkg 
	 ,zipcode ,latlon 
	  , phone, specialty ,effdate,termdate 
	 ,codetype,code,negratetype,serviceamt,poscode,comments ,codeversion ,rownum as rownumid
	 from asa
	 )
	 select *
	 from asa1
	 
	 <where>
		 <if test="pagelow != null" >
	   			and ( rownumid &gt;=${pagelow} and rownumid &lt;=${pageup})
			</if>
		</where>
	</select>
	<select id="selProbylocationtaxidFHFsize"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode}
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos as (
	     select name,address1,city,St, zip, phone, spec1, taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1, taxid,npi,specialty
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlpkg
     ,substr(a.postalcode,1,5) as zipcode 
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='F' and a.prov_npi_1 is not null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
 	)
	,c as(
	 select c.cntlpkg,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
	 from TBL_FH_FRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate, '' as termdate  
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a1 a
	   <if test="ppono != null" >
	   inner join ppos e on a.prov_npi_1=e.npi and a.provtaxid=e.taxid 
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlpkg=c.cntlpkg  
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
	 )
		select count(1) as total
		 from f
	</select>
	
	<select id="selProbylocationtaxidFHFS"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			<if test="provst != null" >
		  		,'' AS latlon
		  	</if>
		  	<if test="provst == null" >
			, power(abs(latitude-(${ix1}))*abs(latitude-(${ix1}))+abs(longitude-(${iy1}))*abs(longitude-(${iy1})),0.5)*111 as latlon
			</if>
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		substr(a.keyid,1,instr(a.keyid,'_')-1) as keyid,
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos2 as (
	     select name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty
	     )
	     ,ppos as (
	     select distinct a.*
	     from ppos0 a 
	     inner join ppos2 b on a.name=b.name
	                        and a.address1=b.address1
	                        and a.city=b.city
	                        and a.St=b.St
	                        and a.zip=b.zip
	                        and a.phone=b.phone
	                        and a.spec1=b.spec1
	                        and a.keyid=b.keyid
	                        and a.taxid=b.taxid
	                        and a.npi=b.npi
	                        and a.specialty=b.specialty
	                        and a.effdate=b.effdate
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlpkg
     ,substr(a.postalcode,1,5) as zipcode 
     <if test="taxid == null" >
     ,d.latlon 
     </if>
     <if test="taxid != null" >
     ,'' as latlon
     </if>
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='F' and a.prov_npi_1 is  null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
     order by  
       <if test="taxid == null" >
     	<if test="seq == 'filDistance'" >
				 d.latlon,
		</if>
		</if>
		a.name
 	)
	,c as(
	 select c.cntlpkg,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
	 from TBL_FH_FRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
 	,a as(
	 select a1.*
	 from a1
	 
	 <if test="ppono == 38" >
	 --WHERE  rownum&lt;=100 --and exists(select 1 from c where a1.cntlpkg=c.cntlpkg )
	 </if>
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate,e.termdate 
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a
	   <if test="ppono != null" >
	   inner join ppos e on a.provtaxid=e.taxid and a.internalprovnum = e.keyid
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlpkg=c.cntlpkg     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		 order by serviceamt
	 )
	,asa as(
		 select b.*
		 from f
		 inner join b on f.prov_npi_1=b.prov_npi_1
		 --and f.provtaxid=b.provtaxid
		 and f.internalprovnum =b.internalprovnum
		 and f.provtype =b.provtype
		 and f.name=b.name
		 and f.address1=b.address1
		 and f.city=b.city
		 and f.state=b.state
		 and f.postalcode=b.postalcode
		 --and f.cntlpkg=b.cntlpkg
		 and f.serviceamt=b.serviceamt
		 
		  order by
		    <if test="seq == 'filDistance'" >
				 b.latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 f.serviceamt,
			 </if>
			 <if test="seq == 'filSpec'" >
				 specialty,
			 </if>
		     b.name,b.prov_npi_1--,b.provtaxid
		     ,b.internalprovnum ,specialty,
		     b.provtype ,b.address1,b.city,b.state ,b.postalcode ,b.codetype,b.code,b.poscode,b.serviceamt
	)
	,asa1 as (
	 select prov_npi_1--,provtaxid
	 ,internalprovnum ,provtype ,
	 name, 
	 address1, city, 
	 state, 
	 postalcode --,cntlpkg 
	 ,zipcode ,latlon 
	  , phone, specialty ,effdate,termdate 
	 ,codetype,code,negratetype,serviceamt,poscode,comments ,codeversion ,rownum as rownumid
	 from asa
	 )
	 select *
	 from asa1
	 
	 <where>
		 <if test="pagelow != null" >
	   			and ( rownumid &gt;=${pagelow} and rownumid &lt;=${pageup})
			</if>
		</where> 
	</select>
	<select id="selProbylocationtaxidFHFSsize"  parameterType="adppo" resultMap="adppoResult">
	with tempcodes as(
	  select b.codes
	  from TBL_FH_RATE_CODES b
	  <where>
			  	<if test="Provcode != null" >
			 	and b.codes=#{Provcode} 
			 	</if>
	    </where>
	) 
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	<if test="ppono != null" >
		,ppos0 as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		substr(a.keyid,1,instr(a.keyid,'_')-1) as keyid,
    		a.taxid,a.npi , b.specialty,a.effdate,a.termdate 
		   FROM PPO_${ppono} a 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 ,ppos  as (
	     select name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty,max(effdate) as effdate
	     from ppos0
	     group by name,address1,city,St, zip, phone, spec1,keyid,taxid,npi,specialty
	     )
	</if>
	 ,a1 as(
     select distinct a.prov_npi_1,a.provtaxid,a.internalprovnum ,a.provtype ,a.name,
     upper(a.address1) as address1,
     upper(replace(a.city,' ','')) as city,
     upper(replace(a.state,' ','')) as state,
     a.postalcode
     ,a.cntlpkg
     ,substr(a.postalcode,1,5) as zipcode 
     from TBL_FH_PRDT a
     <if test="taxid == null" >
     inner join ziplatlon d on substr(a.postalcode,1,5) =substr(d.zipcode ,1,5) 
     </if>
     WHERE   a.provtype='F' and a.prov_npi_1 is  null
     			 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				  <if test="taxid != null" >
								and a.prov_npi_1=#{taxid}
				 </if>
 	)
	,c as(
	 select c.cntlpkg,
	 c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
	 from TBL_FH_FRATE_DETAILS c
	 inner join tempcodes b on c.code=b.codes
	)
	,aa as (
	   select   a.* 
	   	 <if test="ppono != null" >
	 		, e.phone, e.specialty ,e.effdate, '' as termdate  
		 </if>
		 <if test="ppono == null" >
		 	, 'XXXXXXXXXX' as phone, ' ' as specialty ,'' as effdate, '' as termdate 
		 </if>
	   from a
	   <if test="ppono != null" >
	   inner join ppos e on a.provtaxid=e.taxid and a.internalprovnum = e.keyid
	   and a.state=e.St 
	   and a.city=e.city
	   and  replace(replace(a.address1,',',''),' ','')=replace(replace(e.address1,',',''),' ','')
	   and zipcode = e.zip
	   </if>
	 )
	 ,b as( 
		 select   a.*
		  ,c.codetype,c.code,c.negratetype,c.serviceamt,c.poscode,c.comments ,c.codeversion
		  from aa a  
		  inner join c on a.cntlpkg=c.cntlpkg     
	 )
	 ,f as(
		  select prov_npi_1--,provtaxid
		  ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
		  ,max(serviceamt) as serviceamt
		 from b
		 group by prov_npi_1--,provtaxid
		 ,internalprovnum ,provtype ,name,address1,city,state,postalcode--,cntlpkg
	 )
	 select count(1) as total
	from f
	</select>
	 
	
	<select id="selProbympi"  parameterType="adppo" resultMap="adppoResult">
	with a as (
		select a.*
		,b.rate_id,b.npi,b.tin_type,b.tin_value
		,c.negotiated_type,c.negotiated_rate,c.expiration_date,c.service_code,c.billing_class,c.billing_code_modifier,c.additional_information
		from tbl_mpirates_inn_network a 
		inner join tbl_mpirates_inn_negoprov b on a.network_id=b.network_id
		inner join tbl_mpirates_inn_negorates c on a.network_id=c.network_id and b.rate_id=c.rate_id
		 <where>
			  	<if test="Provcode != null" >
			 	and billing_code=#{Provcode} 
			 	</if>
			 	<if test="taxid != null" >
								and b.npi=#{taxid}
				 </if>
	    </where> 
	)
	,prate as(
		select a.*
		from a 
		where a.billing_class='professional'
	)
	,frate as(
		select a.*
		from a 
		where a.billing_class='institutional'
	)
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
			<if test="provst != null" >
		  		,'' AS latlon
		  	</if>
		  	<if test="provst == null" >
			, power(abs(latitude-(${ix1}))*abs(latitude-(${ix1}))+abs(longitude-(${iy1}))*abs(longitude-(${iy1})),0.5)*111 as latlon
			</if>
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	
		,ppos as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		 a.npi , b.specialty,a.effdate,a.termdate  ,a.type,c.latlon
    		<if test="ppono != null" >
    		FROM PPO_${ppono} a 
    		</if>
    		<if test="ppono == null" >
    		FROM PPO_40 a 
    		</if> 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 
	, dd as(    
	select * 
	from ppos a
	inner join prate b on a.npi=b.npi
	)

	  ,asa as (
	select name,address1,city,St as state, zip as zipcode,latlon,phone,specialty,effdate,termdate 
   ,negotiated_rate as serviceamt,service_code as poscode,billing_class as codeversion,service_name as comments
	from dd a
	
	where  (a.type='P'  or a.type='F'  ) and service_code='11'
	       
	 order by 
	        <if test="seq == 'filDistance'" >
				 a.latlon,
			 </if>
			 <if test="seq == 'filPrice'" >
				 a.negotiated_rate,
			 </if>
			 <if test="seq == 'filSpec'" >
				 a.specialty,
			 </if>
	 a.name,a.address1,a.city,a.St, a.zip, a.phone, a.spec1,a.type
 )
 ,asa1 as (
 select name,address1,city,state,zipcode,latlon,phone,specialty,effdate,termdate 
       ,serviceamt,poscode,codeversion,comments ,rownum as rownumid
 from asa
 )
 select *
 from asa1
 <where>
       <if test="pagelow != null" >
	   			and ( rownum &gt;=${pagelow} and rownum &lt;=${pageup})
			</if>
</where>
	 
	</select>
	
	<select id="selProbympisize"  parameterType="adppo" resultMap="adppoResult">
	with a as (
		select a.*
		,b.rate_id,b.npi,b.tin_type,b.tin_value
		,c.negotiated_type,c.negotiated_rate,c.expiration_date,c.service_code,c.billing_class,c.billing_code_modifier,c.additional_information
		from tbl_mpirates_inn_network a 
		inner join tbl_mpirates_inn_negoprov b on a.network_id=b.network_id
		inner join tbl_mpirates_inn_negorates c on a.network_id=c.network_id and b.rate_id=c.rate_id
		 <where>
			  	<if test="Provcode != null" >
			 	and billing_code=#{Provcode} 
			 	</if>
			 	<if test="taxid != null" >
								and b.npi=#{taxid}
				 </if>
	    </where> 
	)
	,prate as(
		select a.*
		from a 
		where a.billing_class='professional'
	)
	,frate as(
		select a.*
		from a 
		where a.billing_class='institutional'
	)
	<if test="taxid == null" >
	,ziplatlon as(
			select latitude,longitude,zipcode 
		  	from tbl_zipcodes 
			<where>   
					<if test="provst == null" >
						   AND (latitude &gt;= ${ox1}) and (latitude &lt;= ${ox2})
						   AND (longitude &lt;= ${oy2}) and (longitude &gt;= ${oy1})
					</if>  
			 		<if test="provst != null" >
			 			and upper(replace(state,' ',''))=#{provst}
			 		</if>
			</where>
	) 
	</if>
	
		,ppos as (
		 	Select distinct upper(a.name) as name, upper(a.address1) as address1,
    		upper(replace(a.city,' ',''))  as city,upper(replace(a.St,' ','')) as St, a.zip, a.phone, a.spec1,
    		 
    		 a.npi , b.specialty,a.effdate,a.termdate  ,a.type
    		<if test="ppono != null" >
    		FROM PPO_${ppono} a 
    		</if>
    		<if test="ppono == null" >
    		FROM PPO_40 a 
    		</if> 
		   inner JOIN Tbl_Specialty b ON a.spec1 = b.specialty_ID 
		   <if test="taxid == null" >
		   inner join ziplatlon c on a.zip =c.zipcode 
		   </if>
		  <where> 
  				 a.effdate&lt;=sysdate and a.termdate&gt;=sysdate
				 <if test="provst != null" >
  				 				and upper(replace(a.st,' ',''))=#{provst}
  				 </if>
				 <if test="spec != null" >
								and a.spec1 in (${spec})
				 </if>
				 <if test="provname != null" >
								and upper(a.name) like '%${provname}%'
				 </if>
				 
				 <if test="taxid != null" >
								and a.npi=#{taxid}
				 </if>
				 
				 
		  </where>
		)
		 
	, dd as(    
		select * 
		from ppos a
		inner join prate b on a.npi=b.npi
	)
	
		select count(1) as total
		from dd a
		where  (a.type='P'  or a.type='F'  ) and service_code='11'
	
	</select>
	
	
	
	
	<select id="selPpobymember"  parameterType="adppo" resultMap="adppoResult">
			with x as(
			select Employee_SSN,Group_Number,Master_Group
			from Tbl_Employee_Eligibility
			<where>
				<if test="mastgroup != null" >
				and Master_Group =#{mastgroup}
			 	</if>
			 	
			 	<if test="ssn != null" >
				and Employee_SSN =#{ssn}
			 	</if>
			</where>
			)
			SELECT DISTINCT e.PPO, e.PPO_name
			        , CAST((CASE f.WLTEligFlag WHEN 1 THEN 'Medical' WHEN 2 THEN 'Dental' WHEN 3 THEN 'Vision'
			        ELSE '' END) As Varchar2(50)) As specific_plan_type
			        , d.CoverageTypeID, c.nationalPPO, e.PPO_WebUrl ,1  as seq
			      FROM  Tbl_master_Group  a  
			      INNER JOIN  tbl_group  b  ON a.mastergroup = b.master_Group
			      INNER JOIN  BenefitPackages  c  ON b.gr_number = c.groupID 
			      INNER JOIN  coverage  d  ON c.coverageID = d.coverageID
			      INNER JOIN tbl_PPO  e  ON c.providerNetworkID = e.ppo
			      INNER JOIN  CoverageTypes  f  ON d.coveragetypeid=f.coveragetypeid
			      INNER JOIN (  
			          SELECT DISTINCT x.Group_Number, '1' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE  y.Medical='T'
			          UNION
			          SELECT DISTINCT x.Group_Number, '2' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE y.Dental='T'
			          UNION
			          SELECT DISTINCT x.Group_Number, '3' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE  y.Vision='T'
			        ) g on f.WLTEligFlag=g.CvgType
			      WHERE  b.gr_number = g.Group_Number and sysdate between c.starting and c.ending
			    UNION  -- Secondary PPO
			      SELECT DISTINCT e.PPO, e.PPO_name
			        , (CASE f.WLTEligFlag WHEN 1 THEN 'Medical' WHEN 2 THEN 'Dental' WHEN 3 THEN 'Vision'
			        ELSE '' END) || '; Secondary PPO' As specific_plan_type
			        , d.CoverageTypeID, c.nationalPPO, e.PPO_WebUrl, 2 as seq
			      FROM  Tbl_master_Group  a  
			      INNER JOIN tbl_group  b  ON a.mastergroup = b.master_Group
			      INNER JOIN BenefitPackages  c  ON b.gr_number = c.groupID 
			      INNER JOIN coverage  d  ON c.coverageID = d.coverageID
			      INNER JOIN tbl_PPO  e  ON c.nationalppo= e.ppo
			      INNER JOIN CoverageTypes  f  ON d.coveragetypeid=f.coveragetypeid
			      INNER JOIN (  
			          SELECT DISTINCT x.Group_Number, '1' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE  y.Medical='T'
			          UNION
			          SELECT DISTINCT x.Group_Number, '2' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE   y.Dental='T'
			          UNION
			          SELECT DISTINCT x.Group_Number, '3' As CvgType
			          FROM  x  
			            INNER JOIN Tbl_EligibilityHistory y  
			              ON x.Master_Group=y.Master_Group and x.Employee_SSN=y.Employee_SSN
			          WHERE   y.Vision='T'
			        ) g on f.WLTEligFlag=g.CvgType
			      WHERE  b.gr_number = g.Group_Number and sysdate between c.starting and c.ending
			      AND c.providerNetworkID!=c.nationalppo
			      ORDER BY specific_plan_type, SEQ
  </select>
  
	
	<select id="selPpobymastergroup"  parameterType="adppo" resultMap="adppoResult">		  
			 
			 <if test="newfeaturesind ==0" >
			with aa as(
			select a.PPO,a.plan_type_id,a.master_group,a.NationalPPO,a.gr_number
			from tbl_group a
			INNER JOIN tbl_master_Group  b  ON a.master_group = b.mastergroup
			<where>
				<if test="corporationid != null" >
				and b.corporationID =  #{corporationid}
				</if>
				
				<if test="mastgroup != null" >
				and  b.mastergroup =#{mastgroup}
				</if>
			</where> 
			)
			,ppos as(
			  SELECT DISTINCT a.PPO, a.PPO_name, c.specific_plan_type, a.PPO As nationalPPO, a.PPO_WebUrl
			  FROM tbl_PPO   a  
			  INNER JOIN aa  ON a.PPO =  aa.PPO
			  INNER JOIN tbl_plan_type   c  ON aa.plan_type_id = c.plan_type_ID  
			  WHERE   a.insql != 0
			    UNION
			  SELECT DISTINCT a.PPO, a.PPO_name, c.specific_plan_type, a.PPO As nationalPPO, a.PPO_WebUrl
			  FROM tbl_PPO   a  
			  INNER JOIN aa  ON a.PPO = (CASE WHEN aa.NationalPPO=116 THEN 16 ELSE aa.NationalPPO END) 
			  INNER JOIN tbl_plan_type   c  ON aa.plan_type_id = c.plan_type_ID 
			  WHERE  a.insql != 0
			  )
			  select DISTINCT *
			  from ppos
			  Order by PPO_name
			</if>
			
			<if test="newfeaturesind ==1" >
			 
			with aa as(
			select a.PPO,a.plan_type_id,a.master_group,a.NationalPPO,a.gr_number
			from tbl_group a
			INNER JOIN tbl_master_Group  b  ON a.master_group = b.mastergroup
			<where>
				<if test="corporationid != null" >
				and b.corporationID =  #{corporationid}
				</if>
				
				<if test="mastgroup != null" >
				 and b.mastergroup =#{mastgroup}
				</if>
			</where> 
			)
			,ppos as(
			SELECT DISTINCT e.PPO, e.PPO_name
			    , (CASE f.WLTEligFlag WHEN 1 THEN 'Medical' WHEN 2 THEN 'Dental' ELSE '' END) as specific_Plan_Type
			    ,  d.CoverageTypeID, e.PPO As nationalPPO, e.PPO_WebUrl
			  FROM  aa
			  INNER JOIN BenefitPackages   c  ON aa.gr_number = c.groupID  
			  INNER JOIN coverage   d  ON c.coverageID = d.coverageID 
			  INNER JOIN tbl_PPO   e  ON c.providerNetworkID = e.ppo and e.InSQL=1
			  INNER JOIN CoverageTypes   f  ON d.coveragetypeid=f.coveragetypeid
			  WHERE  f.WLTEligFlag in (1, 2)
			 UNION
			  SELECT DISTINCT e.PPO, e.PPO_name
			    , (CASE f.WLTEligFlag WHEN 1 THEN 'Medical' WHEN 2 THEN 'Dental' ELSE '' END) as specific_Plan_Type
			    ,  d.CoverageTypeID, e.PPO As nationalPPO, e.PPO_WebUrl
			  FROM  aa
			  INNER JOIN BenefitPackages   c  ON aa.gr_number = c.groupID and c.providerNetworkID!=c.nationalPPO  
			  INNER JOIN coverage   d  ON c.coverageID = d.coverageID 
			  INNER JOIN tbl_PPO   e  ON c.nationalPPO = e.ppo and e.InSQL=1
			  INNER JOIN CoverageTypes   f  ON d.coveragetypeid=f.coveragetypeid
			  WHERE   f.WLTEligFlag in (1, 2)
			)
			  select DISTINCT *
			  from ppos
			  Order by coverageTypeID, ppo_name
			</if>
	</select>	  
			  
			  
			  
	<select id="selPpobyid"  parameterType="adppo" resultMap="adppoResult">	
	select ppo, ppo_name   from tbl_PPO  
	<where>
		<if test="ppono != null" >
				and ppo=#{ppono}
			</if>
	</where> 
	</select>
	<select id="selSubgroupinfo"  parameterType="adppo" resultMap="adppoResult">	
	select ppo,nationalPPO  from tbl_group  
		<where>
			<if test="grnumber != null" >
					and gr_number=#{grnumber}
				</if>
		</where> 
	</select>
	
	<select id="selCorporationbyid"  parameterType="adppo" resultMap="adppoResult">	
	select corporationid,newfeaturesind from tbl_corporation
		<where>
			<if test="corporationid != null" >
					and corporationid=#{corporationid}
				</if>
		</where> 
	</select>
	
	 
</mapper>
